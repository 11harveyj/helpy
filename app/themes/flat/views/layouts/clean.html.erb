<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
	<head>
		<%= render partial: 'layouts/head' %>
	</head>
<body>
<script>
  ga('set', 'location', location.href.split('#')[0]);
  ga('send', 'pageview', { "title": document.title });
</script>

<nav id="menu">
	<ul class="nav" data-hook="header-main-nav">
		<li><%= link_to "#{AppSettings['settings.product_name'] + " " if AppSettings['settings.product_name']}" "#{AppSettings['settings.site_name']}", root_path %></li>
		<li><hr/></li>
		<li class="hidden-lg hidden-md hidden-sm"><%= render('result/search_form') %></li>

		<%= content_tag :li, link_to(t(:your_tickets), tickets_path), data: { hook: 'tickets-nav' } if user_signed_in? %>
		<%= content_tag :li, link_to(t(:knowledgebase), categories_path, class:'kblink') if Settings.knowledgebase %>
		<%= content_tag :li, link_to(t(:community), forums_path) if Settings.forums %>
		<%= content_tag :li, link_to(t(:ask_a_question), new_topic_path), data: { hook: 'question_nav' } %>
		<%#= content_tag :li, link_to("#{t(:back_to).titleize} #{AppSettings['settings.parent_company']}", AppSettings['settings.parent_site'] %>
		<%= content_tag :li, link_to(t(:locale), select_locale_path) %>

		<% if user_signed_in? %>
		<%= content_tag :li, link_to(t(:your_profile), edit_user_registration_path) %>
		<%= content_tag :li, link_to('Admin', admin_root_path) if current_user.is_editor? %>
		<%= content_tag :li, link_to(t(:logout), destroy_user_session_path) %>
		<% else %>
		<%= content_tag :li, link_to(t(:login), new_user_session_path) %>
		<% end %>
	</ul>
</nav>

<main id="panel">
	<header class-"jumbotron white">
		<div class="container">
			<div class="col-md-3 col-sm-3 col-xs-10 text-left">
				<%= link_to image_tag("#{AppSettings['design.header_logo']}", width: 40, class: "pull-left logo") + "#{AppSettings['settings.product_name'] + " " if AppSettings['settings.product_name']}" "#{AppSettings['settings.site_name']}", root_path, class: 'navbar-brand', responsive: true %>
			</div>

			<!-- <div class="col-lg-7 col-md-7 col-sm-7 text-right hidden-xs">
				<div class="navbar-form navbar-right form-group has-feedback right-inner-addon hidden-xs">
				  <%= form_tag result_path, method: :get, id: 'search-form', remote: (params[:controller] == 'result') do %>
				    <div class="top-search input-group">
				      <%= text_field_tag('q', nil, placeholder: t(:search_placeholder, default: "Enter a keyword, topic, or question"), id: 'search-field', class: 'form-control', value: params[:q], style: 'width: 100%;') %>
				      <div class="input-group-btn">
				        <button type="submit" class="btn btn-default" aria-label="Search">
				          <span class="glyphicon glyphicon-search"></span>
				        </button>
				      </div>
				    </div>
				  <% end # form %>
				</div>
			</div> -->
			<div class="col-lg-9 col-md-9 col-sm-9 col-xs-2 text-right">
				<ul class="list-inline" data-hook="header-mini-nav">
					<%= content_tag :li, link_to(t(:ask_a_question), new_topic_path), data: { hook: 'question_nav' } %>
					<% if user_signed_in? %>
					<%= content_tag :li, link_to(t(:your_profile), edit_user_registration_path) %>
					<%= content_tag :li, link_to(t(:logout), destroy_user_session_path) %>
					<% else %>
					<%= content_tag :li, link_to(t(:login), new_user_session_path) %>
					<% end %>
					<li><h2 class="toggle-button fa fa-bars"></h2></li>
					<%= content_tag :li, link_to(avatar_image(current_user, size=20), edit_user_registration_path) if user_signed_in? %>
				</ul>

			</div>
	</header>

	<div class="jumbotron flat-main-panel">
		<div class="container">
			<div class="col-md-12">
				<%= yield :home %>
				<%= render 'layouts/page_title' unless params[:controller] == 'home' %>
			</div>
		</div>
	</div>

	<div class="content container">
		<div id="body-wrapper" class="container">
				<div class="row">
					<div class="col-md-12">
						<div id="main-body" >
							<%#= bootstrap_flash %>
							<div id="main-content">
								<%= yield %>
							</div>
						</div>
					</div>
				</div>
		</div>
	</div>
</main>

	<div id="footer-wrapper">
		<div class="container">
			<%= render :partial => 'layouts/footer' %>
		</div>
	</div>

<script>
  var slideout = new Slideout({
    'panel': document.getElementById('panel'),
    'menu': document.getElementById('menu'),
    'padding': 256,
    'tolerance': 70,
		'side': 'right'
  });

	// Make sure we are starting with it closed
	$(document).on("page:load", function(){
	  $("html").removeClass("slideout-open");
	});

	// Toggle button
	document.querySelector('.toggle-button').addEventListener('click', function() {
		slideout.toggle();
	});
</script>

</body>
</html>
